window._tt_ls={getParameter:function(t,e){var r=new RegExp(e+"=(\\w+)"),a=t.match(r);return a?a[1]:null},getTpId:function(t){return this.getParameter(t,"tpid")},getGcLid:function(t){return this.getParameter(t,"gclid")},getUtmSource:function(t){return this.getParameter(t,"utm_source")},saveOnLocalStorage:function(t,e){window.localStorage.setItem(t,e)},removeFromUrl:function(t){var e=t.match(/\?(tpid=(\w+)&)/);if(e)return t.replace(e[1],"");var r=t.match(/\?tpid=(\w+)/);if(r)return t.replace(r[0],"");var a=t.match(/&tpid=(\w+)/);return a?t.replace(a[0],""):t},updateUrl:function(t){window.history.pushState(null,null,t)},init:function(){try{var t=window.location.href,e=this.getGcLid(t),r=this.getTpId(t),a=this.getUtmSource(t),i=t;r&&(this.saveOnLocalStorage("tpid",r),i=this.removeFromUrl(t),this.updateUrl(i)),e&&this.saveOnLocalStorage("gclid",e),a&&(this.saveOnLocalStorage("utm_source",a),this.saveOnLocalStorage("utm_source_updated_at",(new Date).toString()))}catch(n){}}},window._tt_ls.init();window._tpt=Array.isArray(window._tpt)||window._tpt==undefined?function(t){function e(t){if("orderSubmit"===t.event){l.merchant_hostname=location.hostname,l.event="orderSubmit";var e=i("tpid"),n=i("gclid");n&&(l.gclid=n),e&&(l.tpid=e),r()}else{var o=s[t.event];"function"==typeof o&&o(t)}}function i(t){return window.localStorage.getItem(t)}function n(){l={}}function c(t,e){var n,o=[];for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=e?e+"["+n+"]":n,r=t[n];o.push(null!==r&&"object"==typeof r?c(r,i):encodeURIComponent(i)+"="+encodeURIComponent(r))}return o.join("&")}function r(){p(u+"/api/v1/orders?"+c(l,null),function(t){d&&"success"===t.status&&console.log("Order sent correctly")}),n()}function o(t){return(t=t||[]).forEach(function(t){e(t)}),{push:e}}var a,u="https://www.trovaprezzi.it",d=!1,l={},s={setAccount:function(t){l.merchant_id=t.id},setOrderId:function(t){l.order_id=t.order_id},setEmail:function(t){l.email=t.email},addItem:function(t){l.items=l.items||[],l.items.push({sku:t.sku,product_name:t.product_name})},setAmount:function(t){l.amount=t.amount},setDebug:function(t){"dev"===t.env?(u="https://trovaprezziinternal",d=!0):"lab"===t.env?(u="https://lab.trovaprezzi.it",d=!0):d=!(u="https://www.trovaprezzi.it")}},p=(a=0,function(t,e,n){var o="_jsonp_"+a++;t.match(/\?/)?t+="&callback="+o:t+="?callback="+o;var i=document.createElement("script");i.type="text/javascript",i.src=t,i.onerror=function(){d&&console.log("Order sent but failed")},window[o]=function(t){e.call(n||window,t),document.getElementsByTagName("head")[0].removeChild(i),i=null,delete window[o]},document.getElementsByTagName("head")[0].appendChild(i)});return o(t)}(window._tpt):window._tpt;