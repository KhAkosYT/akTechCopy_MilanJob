(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["/scripts/cart"],{

/***/ "./resources/assets/scripts/cart.js":
/*!******************************************!*\
  !*** ./resources/assets/scripts/cart.js ***!
  \******************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var swiper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! swiper */ "./node_modules/swiper/swiper.esm.js");
/*
* EVOLVE Floating Cart
* 1.1.0
*/

(function ($) {
  // updateFragments
  function updateFragments(response) {
    //console.log(response);

    if (response.error) {
      //console.log(response.message);
      $('.cart_notice').html(response.message[0].notice);
      return;
    }
    $('#cart_container').html(response['fragments']['div.cart-content']);
    $('#cart_subtotal').html(response['fragments']['a.cart-subtotal']);
    $('#cart_menu_update').replaceWith(response['fragments']['a.cart-customlocation']);
  }

  // Submit on click
  $('.single_add_to_cart_button').click(function (e) {
    e.preventDefault();

    // Open Modal
    floatingCartToggle();
    var $form = $(this).closest('.cart'),
      id = $(this).val(),
      product_qty = $form.find('input[name=quantity]').val() || 1,
      product_id = $form.find('input[name=product_id]').val() || id,
      variation_id = $form.find('input[name=variation_id]').val() || 0;

    //console.log("PRODUCTID" + product_id);
    //console.log("product_qty" + product_qty);
    //console.log("id" + id);
    //console.log("button" + JSON.stringify($(this).val()));

    var data = {
      action: 'woocommerce_ajax_add_to_cart',
      product_id: product_id,
      product_sku: '',
      quantity: product_qty,
      variation_id: variation_id
    };
    var loader = $(".loader");

    // Ajax Call
    $.ajax({
      type: 'post',
      // url: woocommerce_params.ajax_url,
      url: '/frontend-requests/action/woocommerce_ajax_add_to_cart/',
      data: data,
      beforeSend: function beforeSend(response) {
        loader.show();
      },
      complete: function complete(response) {
        loader.hide();
      },
      success: function success(response) {
        // Update cart container
        // Check upsell
        upsellProduct();
        updateFragments(response);
      }
    });
    return false;
  });

  //Check upsell product cart
  function upsellProduct() {
    //console.log("Clicked upsell")
    //Ajax call with two random values
    var data = {
      action: 'upsell_products'
    };
    $('#wrapper-upsell').empty();
    $.post('/frontend-requests/action/upsell_products/', data, function (res) {
      if (res.success) {
        if (res.data === undefined || res.data === null || res.data === '') {
          $('#upsell-div').addClass('hidden');
        } else {
          $('#wrapper-upsell').append(res.data);
          $('#upsell-div').removeClass('hidden');

          /* Count elements */
          var elem = document.getElementById("wrapper-upsell");
          if (elem.childElementCount <= 3) {
            document.getElementById("button-next-upsell").classList.add("hidden");
            document.getElementById("button-prev-upsell").classList.add("hidden");
          } else {
            document.getElementById("button-next-upsell").classList.remove("hidden");
            document.getElementById("button-prev-upsell").classList.remove("hidden");
          }
        }
      }
    });
  }

  // Toggle the Floating Cart
  function floatingCartToggle(action) {
    //console.log("Clicked floatingCartToggle")
    $(".cd-panel").toggleClass('cd-panel--is-visible');
    $('body').delay(5000).toggleClass('cart-modal-active');
    if (action == "close") {
      setTimeout(function () {
        $(' .wc-timeline-modal-cover').delay(5000).toggleClass('opened');
      }, 600);
    } else {
      $(' .wc-timeline-modal-cover').delay(5000).toggleClass('opened');
    }
  }
  $('.wc-timeline-modal-cover').click(function (e) {
    floatingCartToggle('close');
  });

  // Close trigger
  $('.hide_panel').click(function (e) {
    floatingCartToggle('close');
  });

  // Open trigger
  $(document).on('click', '.open_panel', function (e) {
    //console.log("Clicked floatingCartToggle")
    floatingCartToggle();

    // Check upsell
    upsellProduct();
  });

  // removeItem from cart
  function removeItem(key) {
    return jQuery.ajax({
      // url: '/wp-admin/admin-ajax.php',
      url: '/frontend-requests/action/wc_timeline_remove_item/',
      method: 'post',
      dataType: "json",
      data: {
        key: key
      }
      // data: {action: 'wc_timeline_remove_item', key: key},
    });
  }

  // updateItemQty
  function updateItemQty(key, qty) {
    return jQuery.ajax({
      // url: '/wp-admin/admin-ajax.php',
      url: '/frontend-requests/action/wc_timeline_update_qty/',
      method: 'post',
      dataType: "json",
      data: {
        key: key,
        qty: qty
      }
      // data: {action: 'wc_timeline_update_qty', key: key, qty: qty},
    });
  }

  // Update
  $(document).on('click touch', '.wc-timeline-qty', function () {
    var $qty = $(this).parent().find('.btn-qty'),
      qtyVal = parseFloat($qty.val()),
      max = parseFloat($qty.attr('max')),
      min = parseFloat($qty.attr('min')),
      step = $qty.attr('step');
    if (!qtyVal || qtyVal === '' || qtyVal === 'NaN') {
      qtyVal = 0;
    }
    if (max === '' || max === 'NaN' || max === -1) {
      max = '';
    }
    if (min === '' || min === 'NaN') {
      min = 0;
    }
    if (step === 'any' || step === '' || step === undefined || parseFloat(step) === 'NaN') {
      step = 1;
    } else {
      step = parseFloat(step);
    }
    if ($(this).is('.quantity-up')) {
      if (max && (max === qtyVal || qtyVal > max)) {
        $qty.val(max);
        $(this).closest('.wc-timeline-product').find('.out-of-stock').fadeIn(100);
        return;
      } else {
        $qty.val(parseInt(qtyVal + step));
      }
    } else {
      if (min && (min === qtyVal || qtyVal < min)) {
        $qty.val(min);
      } else if (qtyVal > 0) {
        $qty.val(parseInt(qtyVal - step));
      }
    }
    $qty.trigger('change-qty');
  });
  $(document).on('change-qty', 'input.btn-qty', function () {
    var loader = $('.loader');
    var item = $(this).closest('.wc-timeline-product'),
      itemKey = $(this).attr('data-sku'),
      itemQty = $(this).val();
    loader.show();
    if (itemQty > 0) {
      var updated = updateItemQty(itemKey, itemQty);
      updated.done(function (response) {
        item.find('.qty').text(itemQty);
        // Update cart container
        updateFragments(response);
        loader.hide();
      });
    } else {
      var deleted = removeItem(itemKey);
      deleted.done(function (response) {
        // Update cart container
        updateFragments(response);
        loader.hide();
      });
    }
  });

  // Remove Function
  $(document).on('click', '.wc-timeline-remove', function () {
    var loader = $('.loader');
    var item = $(this).closest('.wc-timeline-product'),
      item_key = item.attr('data-key'),
      deleted = removeItem(item_key);
    loader.show();
    $('.wc-timeline-action').prop('disabled', true);
    deleted.done(function (response) {
      // Update cart container
      updateFragments(response);
      loader.hide();
      // Check upsell
      upsellProduct();
    });
  });

  // Fix for Mix and Match plugin functionality
  // If some plugin not trigger the endpoint correctly, open the cart on product added.
  if ($('.woocommerce-error').length && $('body').hasClass('single-product')) {
    floatingCartToggle();
  }

  /**
   * Custom upsell product slider
   */
  $(document).ready(function () {
    $('.button-navigation').click(function () {
      $(this).parents('.sliderComplete').children('button').removeClass('close').fadeIn(300);
      $(this).addClass('close').fadeOut(300);
      $(this).parents('.sliderComplete').children('.wrapper-upsell').children('.slider-upsell').toggleClass('turn');
    });
    $.ajax({
      type: 'post',
      url: '/frontend-requests/action/get_cart_fragments/',
      success: function success(response) {
        updateFragments(response);
        console.log('cart counter updated');
      }
    });
  });
})(jQuery);
// EVOLVE Floating Cart END

/***/ }),

/***/ 2:
/*!************************************************!*\
  !*** multi ./resources/assets/scripts/cart.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /Users/Shared/Emilio/webdev/EdinetDev/produzione/edi.shop.akinformatica.it/wp-content/themes/ak-informatica-25/resources/assets/scripts/cart.js */"./resources/assets/scripts/cart.js");


/***/ })

},[[2,"/scripts/manifest","/scripts/vendor"]]]);
//# sourceMappingURL=cart.js.map